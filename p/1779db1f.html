<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>logback节点配置 | 凉月の博客</title><meta name="author" content="凉月"><meta name="copyright" content="凉月"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="logback节点配置详解">
<meta property="og:type" content="article">
<meta property="og:title" content="logback节点配置">
<meta property="og:url" content="https://fulsun.github.io/p/1779db1f">
<meta property="og:site_name" content="凉月の博客">
<meta property="og:description" content="logback节点配置详解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fulsun.github.io/medias/featureimages/010.jpg">
<meta property="article:published_time" content="2023-06-16T06:00:33.000Z">
<meta property="article:modified_time" content="2024-10-17T07:06:55.346Z">
<meta property="article:author" content="凉月">
<meta property="article:tag" content="Java日志">
<meta property="article:tag" content="Logback">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fulsun.github.io/medias/featureimages/010.jpg"><link rel="shortcut icon" href="/medias/favicon.png"><link rel="canonical" href="https://fulsun.github.io/p/1779db1f"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"至上次更新后的","messageNext":"天,文章内容可能已过时。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 凉月","link":"链接: ","source":"来源: 凉月の博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'logback节点配置',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-17 07:06:55'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/medias/detail/load.gif" data-lazy-src="/medias/avatar.jpg" onerror="onerror=null;src='/medias/detail/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-heartbeat"></i><span> 我的</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-list"></i><span> 联系</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-user-circle"></i><span> 博主</span></a></li><li><a class="site-page child" href="/contact"><i class="fa-fw fas fa-comments"></i><span> 留言</span></a></li><li><a class="site-page child" href="/journal"><i class="fa-fw fas fa-cogs"></i><span> 日志</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-list"></i><span> JS动画</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/snake/"><i class="fa-fw fas fa-gamepad"></i><span> 贪吃蛇</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/medias/featureimages/010.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="凉月の博客"><span class="site-name">凉月の博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-heartbeat"></i><span> 我的</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-list"></i><span> 联系</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-user-circle"></i><span> 博主</span></a></li><li><a class="site-page child" href="/contact"><i class="fa-fw fas fa-comments"></i><span> 留言</span></a></li><li><a class="site-page child" href="/journal"><i class="fa-fw fas fa-cogs"></i><span> 日志</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-list"></i><span> JS动画</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/snake/"><i class="fa-fw fas fa-gamepad"></i><span> 贪吃蛇</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">logback节点配置</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-16T06:00:33.000Z" title="发表于 2023-06-16 06:00:33">2023-06-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-17T07:06:55.346Z" title="更新于 2024-10-17 07:06:55">2024-10-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java%E6%97%A5%E5%BF%97/">Java日志</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>29分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="logback节点配置"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>

<h2 id="根节点"><a href="#根节点" class="headerlink" title="根节点"></a>根节点</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scan</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scanPeriod</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--TODO : 子节点信息--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><ul>
<li><p>debug : 默认为false , 设置为true时, 将打印出logback内部日志信息, 实时查看logback运行状态。</p>
</li>
<li><p>scan : 配置文件如果发生改变, 将会重新加载, 默认值为true；</p>
</li>
<li><p>scanPeriod : 检测配置文件是否有修改的时间间隔, 如果没有给出时间单位, 默认单位时毫秒, 当scan为true时, 这个属性生效, 默认时间间隔为1min。</p>
</li>
<li><p>可以这样描述配置文件的基本结构: 以<code>&lt;configuration&gt;</code>开头, 后面有零<br>个或多个<code>&lt;appender&gt;</code>元素, 有零个或多个<code>&lt;logger&gt;</code>元素, 有最多一个<code>&lt;root&gt;</code>元素</p>
<p><img src= "/medias/detail/load.gif" data-lazy-src="/p/1779db1f/165b5ffe63f733b6ae41e27198205f5c.png"></p>
</li>
</ul>
<h2 id="子节点"><a href="#子节点" class="headerlink" title="子节点"></a>子节点</h2><ol>
<li><code>&lt;appender&gt;&lt;/appender&gt;</code></li>
<li><code> &lt;logger&gt;&lt;/logger&gt;</code></li>
<li><code>&lt;root&gt;&lt;/root&gt;</code></li>
</ol>
<h3 id="appender"><a href="#appender" class="headerlink" title="appender"></a>appender</h3><p><img src= "/medias/detail/load.gif" data-lazy-src="/p/1779db1f/112157b0614f9474d09dac6d61bd4e7a.png"></p>
<ul>
<li><p><code>&lt;appender&gt;</code> 是 <code>&lt;configuration&gt; </code>的子节点, 是负责写日志的组件。</p>
</li>
<li><p>appender 有两个必要属性 <strong>name , class</strong> 。</p>
<ul>
<li>name指定appender 的名称,</li>
<li>class 指定appender的全限定名</li>
</ul>
</li>
<li><p>class 包括 :</p>
<ul>
<li>ch.qos.logback.core.ConsoleAppender</li>
<li>ch.qos.logback.core.<strong>FileAppender</strong></li>
<li>ch.qos.logback.core.<strong>RollingFileAppender</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scan</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scanPeriod</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- conf file out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;file_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- conf file out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;file_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">loger</span>&gt;</span><span class="tag">&lt;/<span class="name">loger</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="ConsoleAppender"><a href="#ConsoleAppender" class="headerlink" title="ConsoleAppender"></a>ConsoleAppender</h4><blockquote>
<p>把日志添加到控制台, 有如下节点:</p>
</blockquote>
<ul>
<li><p><code>&lt;encoder&gt;</code> : 对日志进行格式化。</p>
</li>
<li><p><code>&lt;target&gt;</code> : 字符串System.out 或者 System.err, 默认 System.out;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;  [%thread] %-5level %logger&#123;50&#125;.%M - %m%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 控制台也要使用UTF-8，不要使用GBK，否则会中文乱码 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console_out&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="FileAppender"><a href="#FileAppender" class="headerlink" title="FileAppender"></a>FileAppender</h4><blockquote>
<p>把日志添加到文件, 有如下节点:</p>
</blockquote>
<ul>
<li><p><code>&lt;file&gt;</code> : 被写入的文件名,可以是相对目录 , 也可以是绝对目录 , 如果目录不存在则会自动创建</p>
</li>
<li><p><code>&lt;append&gt; </code> : 如果是true , 日志被追加到文件结尾 , 如果是false,清空现存文件 , 默认是true</p>
</li>
<li><p><code>&lt;encoder&gt; </code>: 对日志进行格式化 [具体的转换符说明请<a target="_blank" rel="noopener external nofollow noreferrer" href="http://logback.qos.ch/">参见官网</a>.</p>
</li>
<li><p><code>&lt;prodent&gt; </code>: 如果是true, 日志会被安全的写入文件 , 即使其他的FileAppender也会向此文件做写入操作 , 默认是false</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%date [%thread] %-5level %logger - %message%newline<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- conf file out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;file_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>logs/debug.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">append</span>&gt;</span>false<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%date [%thread] %-5level %logger - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="RollingFileAppender-常用"><a href="#RollingFileAppender-常用" class="headerlink" title="RollingFileAppender [常用]"></a>RollingFileAppender [常用]</h4><blockquote>
<p>滚动纪录文件, 先将日志记录到指定文件, 当符合某种条件时, 将日志记录到其他文件, 有如下节点:</p>
</blockquote>
<ul>
<li><p><code>&lt;file&gt;</code> : 被写入的文件名, 可以是相对目录, 也可以解决目录, 如果目录不存在则自动创建。</p>
</li>
<li><p><code>&lt;append&gt;</code> : 如果是true, 日志被追加到文件结尾, 如果是false, 清空现存文件, 默认是true；</p>
</li>
<li><p><code>&lt;encoder&gt;</code> : 对日志进行格式化 [具体的转换符说明请<a target="_blank" rel="noopener external nofollow noreferrer" href="http://logback.qos.ch/">参见官网</a>.]</p>
</li>
<li><p><code>&lt;rollingPolicy&gt; </code>: 当发生滚动时, 决定 RollingFileAppender 的行为, 涉及文件移动和重命名。</p>
</li>
</ul>
<h3 id="滚动策略"><a href="#滚动策略" class="headerlink" title="滚动策略"></a>滚动策略</h3><p>可以在 Logback 的官方文档中找到更多详细信息和示例，这里提供了一些相关的链接：</p>
<ol>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://logback.qos.ch/manual/index.html">Logback Manual</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://logback.qos.ch/manual/appenders.html#rollingPolicy">Rolling Policies</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://logback.qos.ch/manual/appenders.html#SizeAndTimeBasedRollingPolicy">SizeAndTimeBasedRollingPolicy</a></li>
</ol>
<h4 id="TimeBaseRollingPolicy"><a href="#TimeBaseRollingPolicy" class="headerlink" title="TimeBaseRollingPolicy"></a>TimeBaseRollingPolicy</h4><ul>
<li><p>TimeBasedRollingPolicy继承了RollingPolicyBase且实现了TriggeringPolicy接口,。这样的policy可以同时实现<strong>流转策略</strong>和<strong>触发策略</strong>两种功能</p>
</li>
<li><p>RollingFileAppender 的file 子节点可有可无, 通过设置file, 可以为活动文件和归档文件制定不同位置</p>
<ul>
<li><p>当前日志总是纪录到file指定的文件, 活动文件的名称不会改变</p>
</li>
<li><p>如果没有设置file, 活动文件 的名称会根据fileNamePattern的值, 每隔一段时间改变一次, “／”或者“\” 会被当作目录分隔符。</p>
</li>
<li><p>只设置了fileNamePattern，没有设置file：不管是实时生效日志文件名还是归档文件名都是通过fileNamePattern计算出来的，会随着时间的变化而发生日志文件名的差异</p>
</li>
</ul>
</li>
<li><p><code>&lt;rollingPolicy&gt; :</code>告知RollingFileAppender 激活RollingFileAppender滚动</p>
</li>
<li><p><code>&lt;fileNamePattern&gt;</code>: 必要节点, 包含文件及<code>％d</code> 转换符, <code>％d</code>可以包含一个<code>java.text.SimpleDateFormat</code> 制定的时间格式, 如: <code>％d｛yyyy-MM｝</code>,如果直接使用 ％d , 默认格式是<code>yyyy－MM－dd</code>,注：任何一个正斜杠或者是反斜杠都会被当做是目录分隔符。而且当目录不存在的时候也会自动创建，所以我们可以很容易的就把日志放在我们的目标目录。</p>
<ol>
<li><code>/Wombat/foo.%d</code> (天级更新): 当没有指定具体的格式的时候 ，那么就使用默认格式<code>yyyy-MM-dd</code>。<br>每天0点进行日志滚动<br>因为没有设置file配置项，那么在2006年12月23日，日志会输出到文件&#x2F;wombat&#x2F;foo.2006-12-23。在24号0点的时候，日志会定向输出到&#x2F;wombat&#x2F;foo.2006-12-24<br>如果设置了file配置项的值为 &#x2F;wombat&#x2F;foo.txt，那么在2006年12月23号的时候，会输出日志到 &#x2F;wombat&#x2F;foo.txt。在24号零点的时候 &#x2F;wombat&#x2F;foo.txt会被重命名为 &#x2F;wombat&#x2F;foo.txt.2006-12-23。一个新的文件 &#x2F;wombat&#x2F;foo.txt将会被创建，用来接收24号输出的日志</li>
<li><code>/wombat/%d&#123;yyyy/MM&#125;/foo.txt</code> （月级更新）这个会按日期分文件夹<br>在每个月月初的时候，进行日志滚动<br>如果没有设置file配置项，那么在2006年12月的时候，日志会输出到&#x2F;wombat&#x2F;2006&#x2F;12&#x2F;foo.txt，等到过了12月，到达2007年1月的时候，日志会被重定向到&#x2F;wombat&#x2F;2007&#x2F;01&#x2F;foo.txt<br>如果设置了file配置项的值为&#x2F;wombat&#x2F;foo.txt，那么实时日志将总是输出到&#x2F;wombat&#x2F;foo.txt。且在2006年12月的时候，日志会输出到&#x2F;wombat&#x2F;foo.txt，等到过了12月，到达2007年1月的时候，&#x2F;wombat&#x2F;foo.txt会被重命名为&#x2F;wombat&#x2F;2006&#x2F;12&#x2F;foo.txt，并且会创建一个&#x2F;wombat&#x2F;foo.txt用来接收2007年1月份的日志。等到1月31号结束到达2月1号的时候，&#x2F;wombat&#x2F;foo.txt会被重命名为&#x2F;wombat&#x2F;2007&#x2F;01&#x2F;foo.txt，依次类推</li>
<li><code>/wombat/foo.%d&#123;yyyy-ww&#125;.log</code> （周级更新）<br>每周的第一天进行日志的滚动，注意这里每周的第一天的判断是依赖于本地的日历系统<br>关于file配置项设置与否的差异和上述描述类似</li>
<li><code>/wombat/foo%d&#123;yyyy-MM-dd_HH&#125;.log </code>（小时级更新）<br>每一个小时滚动一次日志<br>关于file配置项设置与否的差异和上述描述类似</li>
<li><code>wombat/foo%d&#123;yyyy-MM-dd_HH-mm&#125;.log</code> （分钟级更新）<br>每一分钟滚动一次日志<br>关于file配置项设置与否的差异和上述描述类似</li>
<li><code>wombat/foo%d&#123;yyyy-MM-dd_HH-mm, UTC&#125;.log</code> （指定时区）<br>每一分钟滚动一次日志，在UTC时区下<br>关于file配置项设置与否的差异和上述描述类似</li>
<li><code>foo/%d&#123;yyyy-MM,aux&#125;/%d.log</code> （aux 主从使用）<br>可以看到有两个%d标识符，其中第一个有aux修饰，另一个没有，那么就说明，没有aux修饰的日期为主，有aux修饰的为辅。也可以理解为没有aux修饰的格式为实时写入日志的格式，有aux修改的为归档日志的存储格式<br>那么在这个例子中，归档日志被存储在&#x2F;foo&#x2F;2006-12&#x2F;这个文件夹中。因为主%d没有指明具体的日期时间格式，所以默认为是YYYY-MM-dd。所以日志的文件名为2006-12-01.log</li>
<li><code>wombat/foo.%d.gz </code>（压缩使用）<ul>
<li>TimeBasedRollingPolicy 也是支持日志的自动压缩的，如果日志文件名是以 <code>.gz</code> 或者<code>.zip</code>结尾的话， 那么就会触发这一操作</li>
<li>因为没有指定具体的日期时间格式，所以也是天级滚动日志</li>
<li>如果没有设置file配置项，那么在2006年12月23日的时候，日志会输出到&#x2F;wombat&#x2F;foo.2006-12-23，等到2006年12月24日的时候，日志会被重定向到&#x2F;wombat&#x2F;foo.2006-12-24。而且&#x2F;wombat&#x2F;foo.2006-12-23会被压缩到&#x2F;wombat&#x2F;foo.2006-12-23.gz</li>
<li>如果设置了file配置项的值为&#x2F;wombat&#x2F;foo.txt，那么实时日志将总是输出到&#x2F;wombat&#x2F;foo.txt。么在2006年12月23日的时候，日志会输出到&#x2F;wombat&#x2F;foo.txt，等到2006年12月24日的时候，&#x2F;wombat&#x2F;foo.txt会被重命名为&#x2F;wombat&#x2F;foo.2006-12-23.gz，并且会创建一个&#x2F;wombat&#x2F;foo.txt用来接收2006年12月24日的日志</li>
</ul>
</li>
</ol>
</li>
<li><p><code>&lt;maxHistory&gt;</code>: 可选节点, 控制保留的归档文件的最大数量, 超出数量就删除旧文件, 假设设置每个月滚动, 且<code>&lt;maxHistory&gt; </code>是 6, 则只保存最近6个月的文件, 删除之前的旧文件, 注意: 删除旧文件是哪些为了归档而创建的目录也会被删除。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 按照每天和固定大小(5MB)生成日志文件【最新的日志，是没有日期没有数字的】 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;LOG_HOME&#125;/项目名.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/项目名_%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件保留天数--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;</span></span><br><span class="line"><span class="comment">         &lt;level&gt;TRACE&lt;/level&gt;</span></span><br><span class="line"><span class="comment">         &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;</span></span><br><span class="line"><span class="comment">         &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;</span></span><br><span class="line"><span class="comment">     &lt;/filter&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="SizeBasedTriggeringPolicy"><a href="#SizeBasedTriggeringPolicy" class="headerlink" title="SizeBasedTriggeringPolicy"></a>SizeBasedTriggeringPolicy</h4><ul>
<li><p>查看当前活动文件的大小 , 如果超过指定大小会告知 RollingFileAppender , 触发当前活动滚动 , 只有一个节点 , 用来规定文件大小</p>
</li>
<li><p><code>&lt;maxFileSize&gt;</code> : 活动文件的大小 , 默认10MB,单位有：KB，MB，GB</p>
</li>
<li><p><code>wombat/foo.％i.log.gz </code> 索<strong>引递增</strong>：<code>%i</code> 将会自动在生成的文件名中添加一个数字索引，这个数字会根据滚动的次数递增。比如说，假设您配置的文件名模式为：<code>项目名_%d&#123;yyyy-MM-dd&#125;.%i.log</code></p>
<ul>
<li>那么在某一天的日志中，如果您第一次滚动文件，您会得到类似以下的文件名：</li>
<li><code>项目名_2023-10-01.0.log</code>（第一次）</li>
<li><code>项目名_2023-10-01.1.log</code>（第二次，表示第一个文件已经达到了 5MB 的大小并被滚动）</li>
<li><code>项目名_2023-10-01.2.log</code>（第三次，以此类推）</li>
</ul>
</li>
<li><p>注意</p>
<ul>
<li>不支持也不允许文件压缩</li>
<li>不能设置file属性 . 必须留空</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 按照每天和固定大小(5MB)生成日志文件【最新的日志，是日期最大数字最大的】 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;FILE&quot;</span>  <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 日志文件输出的文件名 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/项目名_%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 日志文件保留天数 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 日志文件最大的大小 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>5MB<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- 日志文件最大的大小 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">triggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- &lt;MaxFileSize&gt;5MB&lt;/MaxFileSize&gt; --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">MaxFileSize</span>&gt;</span>5KB<span class="tag">&lt;/<span class="name">MaxFileSize</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">triggeringPolicy</span>&gt;</span> --&gt;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="SizeAndTimeBasedRollingPolicy"><a href="#SizeAndTimeBasedRollingPolicy" class="headerlink" title="SizeAndTimeBasedRollingPolicy"></a>SizeAndTimeBasedRollingPolicy</h4><p><code>SizeAndTimeBasedRollingPolicy</code> 是 Logback 中用于实现基于时间和文件大小的日志文件滚动策略。它允许开发者在满足一定的时间间隔和文件大小条件下进行日志文件的滚动，从而有效地管理日志文件。按照日期来对日志进行归档，但是同时你又希望限制每个日志文件的大小，</p>
<ul>
<li><strong>fileNamePattern</strong>: 定义生成的日志文件名模式。可以使用 <code>%d</code> 表示日期，<code>%i</code> 用于索引。例如，上述配置表示日期格式为 <code>yyyy-MM-dd</code> 的日志文件，超过大小限制的文件将有递增的数字后缀。</li>
<li><strong>maxHistory</strong>: 定义日志文件的最大保留天数，以便在超过这个天数后自动删除过期的日志文件。</li>
<li><strong>maxFileSize</strong>: 定义每个日志文件的最大大小。当达到此大小限制时，日志文件滚动将会发生，新的文件将会创建。</li>
<li><strong>totalSizeCap</strong>: 限制<strong>合并归档</strong>日志的总大小,。当归档日志文件的总大小超过这个限制时，Logback 会开始删除最旧的归档文件，以确保总大小不超过设定的 <code>totalSizeCap</code> 值。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ROLLING&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 日志文件输出的文件名 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/app.%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 日志文件的最大保留天数 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 文件最大大小 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>5MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">             <span class="comment">&lt;!-- 限制归档日志总大小 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">totalSizeCap</span>&gt;</span>1GB<span class="tag">&lt;/<span class="name">totalSizeCap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ROLLING&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="过滤节点"><a href="#过滤节点" class="headerlink" title="过滤节点"></a>过滤节点</h3><ul>
<li><p>Logback 的过滤器基于三值逻辑（ternary logic）, 允许把它们组装或成链, 从而组成任 意的复合过滤策略。</p>
</li>
<li><p>这里的所谓三值逻辑是说, 过滤器的返回值只能是 ACCEPT、DENY 和 NEUTRAL 的其中一个。</p>
<ul>
<li><p>如果decide()方法返回DENY，则日志事件被丢弃，并且不会考虑后续的过滤器。</p>
</li>
<li><p>如果返回的是NEUTRAL，则会考虑列表中的下一个过滤器。如果没有其他过滤器可供考虑，则正常处理日志事件。</p>
</li>
<li><p>如果返回的是ACCEPT，则日志事件会立即被处理，并跳过剩余的过滤器调用</p>
</li>
</ul>
</li>
<li><p>过滤器一般分为如下几类</p>
</li>
</ul>
<h4 id="级别过滤器（LevelFilter）"><a href="#级别过滤器（LevelFilter）" class="headerlink" title="级别过滤器（LevelFilter）"></a>级别过滤器（LevelFilter）</h4><ul>
<li><p>LevelFilter 根据记录级别对记录事件进行过滤。</p>
</li>
<li><p>如果事件的级别等于配置的级别, 过滤 器会根据 onMatch 和 onMismatch 属性接受或拒绝事件。</p>
</li>
<li><p>下面是个配置文件例子:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 过滤掉非INFO级别 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%-4relative [%thread] %-5level %logger&#123;30&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console_out&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="临界值过滤器（ThresholdFilter）"><a href="#临界值过滤器（ThresholdFilter）" class="headerlink" title="临界值过滤器（ThresholdFilter）"></a>临界值过滤器（ThresholdFilter）</h4><ul>
<li><p>ThresholdFilter 过滤掉低于指定临界值的事件 . 当记录的级别等于或高于临界值时 , ThresholdFilter 的decide()方法会返回NEUTRAL ;</p>
</li>
<li><p>当记录级别低于临界值时 , 事件会被拒绝</p>
</li>
<li><p>下面是个配置文件例子 :</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 过滤掉TRACE和DEBUG级别的日志 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%-4relative [%thread] %-5level %logger&#123;30&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console_out&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="求值过滤器（EvaluatorFilter）"><a href="#求值过滤器（EvaluatorFilter）" class="headerlink" title="求值过滤器（EvaluatorFilter）"></a>求值过滤器（EvaluatorFilter）</h4><ul>
<li><p>EvaluatorFilter 封装了 EventEvaluator（ch.qos.logback.core.boolex.EventEvaluator) , 评估 是否符合指定的条件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.EvaluatorFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">evaluator</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--过滤掉所有日志中不包含hello字符的日志--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">expression</span>&gt;</span></span><br><span class="line">                    message.contains(&quot;hello&quot;)</span><br><span class="line">                <span class="tag">&lt;/<span class="name">expression</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>NEUTRAL<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">evaluator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%-4relative [%thread] %-5level %logger&#123;30&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console_out&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="匹配器（Matchers）"><a href="#匹配器（Matchers）" class="headerlink" title="匹配器（Matchers）"></a>匹配器（Matchers）</h4><ul>
<li><p>尽管能通过调用 String 类的 matches()方法进行模式匹配, 但这会导致每次调用过滤器时都会创建一个全新的 Pattern 对象。</p>
</li>
<li><p>为消除这种开销, 你可以预先定义一个或多个 Matcher 对象。一旦定义 matcher 后, 就可以在求值表达式里重复引用它。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.EvaluatorFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">evaluator</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">matcher</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Name</span>&gt;</span>odd<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- 过滤掉序号为奇数的语句--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">regex</span>&gt;</span>statement [13579]<span class="tag">&lt;/<span class="name">regex</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">matcher</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">expression</span>&gt;</span>odd.matches(formattedMessage)<span class="tag">&lt;/<span class="name">expression</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>NEUTRAL<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">evaluator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%-4relative [%thread] %-5level %logger&#123;30&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console_out&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>至此 , Appender 节点已经介绍完毕.</p>
</blockquote>
<h3 id="logger-节点"><a href="#logger-节点" class="headerlink" title="logger 节点"></a>logger 节点</h3><ul>
<li><p><strong>定义</strong>：<code>logger</code> 节点用于定义特定的 Logger，这些 Logger 可以具有特定的名称、日志级别和不同的 Appender。</p>
</li>
<li><p><strong>用途</strong>：为程序的特定包、类或模块设置不同的日志级别和处理方式，从而实现更加 granular 的日志控制。</p>
</li>
<li><p><code>logger</code> 节点通常包含以下几个主要的属性和子节点：</p>
<ol>
<li><strong>name</strong>: 表示 Logger 的名称，可以是一个具体的类名、包名或根 Logger。</li>
<li><strong>level</strong>: 定义此 Logger 的日志级别，如 <code>TRACE</code>、<code>DEBUG</code>、<code>INFO</code>、<code>WARN</code>、<code>ERROR</code>、<code>OFF</code>。</li>
<li><strong>additivity</strong>: 可选属性，默认为 <code>true</code>。如果设置为 <code>false</code>，则表示该 Logger 不会将日志事件传递给父 Logger。这对于控制日志输出的层级非常有用。</li>
<li><strong>appender-ref</strong>: 指定一个或多个所使用的 Appender，即将输出的日志消息发送到哪里，不同的 Logger 可以引用不同的 Appender 或共享同一个 Appender。。</li>
</ol>
</li>
<li><p>下面是一个包含 <code>logger</code> 节点的示例配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5level %logger&#123;36&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.example.service&quot;</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.example.dao&quot;</span> <span class="attr">level</span>=<span class="string">&quot;ERROR&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>解析示例</p>
<ul>
<li><code>name=&quot;com.example.service&quot;</code>：表示此 Logger 仅适用于该包名下的所有类。日志级别设置为 <code>DEBUG</code>，因此将记录所有 <code>DEBUG</code> 及以上级别的日志。</li>
<li><code>name=&quot;com.example.dao&quot;</code>：仅适用于 <code>com.example.dao</code> 包，级别设置为 <code>ERROR</code>，只记录 <code>ERROR</code> 日志。<code>additivity=&quot;false&quot;</code> 意味着这部分日志不会传递到根 Logger，只有这部分定义的 Appender 才会处理日志。</li>
<li><code>com.example.service</code> Logger 的 <code>additivity</code> 默认设置为 <code>true</code>（隐式），这意味着如果在该 Logger 中记录了一个日志事件，它将传递到根 Logger，最终也会被根 Logger 的 Appender 处理。</li>
<li><code>com.example.dao</code> Logger 的 <code>additivity</code> 设置为 <code>false</code>，因此对于此 Logger 记录的日志事件，只有其直接引用的 Appender（在此例中是 <code>CONSOLE</code>）会处理这些日志，根 Logger 不会记录这些日志。</li>
</ul>
</li>
</ul>
<h3 id="root-节点"><a href="#root-节点" class="headerlink" title="root 节点"></a>root 节点</h3><ul>
<li><p><strong>定义</strong>：<code>root</code> 节点用来定义根 Logger，它是所有 Logger 的祖先。所有未明确设置的 Logger 都会继承根 Logger 的配置。</p>
</li>
<li><p><strong>用途</strong>：定义一个全局的日志级别和 Appender，以捕获所有未指定的 Logger 的日志事件。</p>
</li>
<li><p>Level 属性的值大小写无关, 其值为下面其中一个字符串: TRACE、DEBUG、INFO、 WARN、ERROR、ALL 和 OFF。注<strong>意不能设置为“INHERITED” 或“NULL”</strong>。</p>
</li>
<li><p>元素可以包含零个或多个元素。声明元素后, 会先关闭然后移除全部当前 appender, 只引用声明了的 appender。</p>
</li>
<li><p>如果 root 元素没有引用任何 appender, 就会失去所有 appender。</p>
</li>
<li><p><strong>如下完整案例配置 :</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- conf consoel out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span> =<span class="string">&quot;console_out&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 过滤掉非INFO级别 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 01:conf infoAppender out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;infoAppender&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>logs/info.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置滚动策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPoliy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置日志命名模式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>infoFile.%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--最多保留30天log--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPoliy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 超过150MB时, 触发滚动策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">triggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>150<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">triggeringPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d [%p] %-5level %logger - %msg%newline<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 02:conf debugAppender out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;debugAppender&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>logs/debug.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置滚动策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPoliy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置日志命名模式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>debugFile.%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--最多保留30天log--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPoliy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 超过150MB时, 触发滚动策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">triggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>150<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">triggeringPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d [%p] %-5level %logger - %msg%newline<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 03:conf errorAppender out --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;errorAppender&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>logs/error.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置滚动策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPoliy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置日志命名模式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>errorFile.%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--最多保留30天log--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPoliy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 超过150MB时, 触发滚动策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">triggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>150<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">triggeringPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d [%p] %-5level %logger - %msg%newline<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;ALL&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;infoAppender&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;debugAppender&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;errorAppender&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="logger-和-root的关系"><a href="#logger-和-root的关系" class="headerlink" title="logger 和 root的关系"></a>logger 和 root的关系</h3><ul>
<li><p><strong>层次结构</strong>：每个 <code>logger</code> 节点都有一个名称，它可以是一个特定的包（例如 <code>com.example</code>）或类（例如 <code>com.example.MyClass</code>）。这些 Logger 按树状结构组织，根 Logger 是所有 Logger 的祖先。</p>
</li>
<li><p><strong>传递性</strong>：如果一个 <code>logger</code> 节点没有设置 <code>additivity=false</code>，则它的日志事件会传递到根 Logger，根 Logger 将根据其配置进行处理。</p>
</li>
<li><p><strong>根节点（<code>root</code>）</strong>：全局 Logger，适用于所有未单独定义的 Logger，通常配置最基本的日志处理策略。</p>
</li>
<li><p><strong>Logger 节点（<code>logger</code>）</strong>：用于定义具体的 Logger，针对特定的 logger 可以设置不同的级别和处理方式。</p>
</li>
<li><p><strong>用途和结构的不同</strong>：根 Logger 用于管理全局日志设置，而 Logger 节点用于特定区域或功能模块的详细日志管理。两者结合使用，可以实现灵活的日志记录控制。</p>
</li>
</ul>
<h2 id="logback-执行流程"><a href="#logback-执行流程" class="headerlink" title="logback 执行流程"></a>logback 执行流程</h2><ol>
<li><p>获得过滤链的策略</p>
<p>依据过滤器链返回的结果做出不同的响应。共有三个响应结果:<br><code>FilterReply.DENY</code>, 直接退出, 不执行后续流程<br><code>FilterReply.NEUTRA</code>, 继续向下执行<br><code>FilterReply.ACCEPT</code>, 不进行步骤二,即类型输出类型检查</p>
</li>
<li><p>执行基本的选择规则</p>
<p>主要是比较下level, 如果级别低直接退出后续执行</p>
</li>
<li><p>创建LoggingEvent对象</p>
<p>这个对象包裹一些基本信息, 包括日志界别, 信息本身, 可能的异常信息, 执行时间, 执行线程, 其实一些随日志请求一起发出的数据和MDC。其中MDC是用来装一些额外的上下文信息的。</p>
</li>
<li><p>调用appenders</p>
<p>此时logback会调用appender的doAppender, 如果appender里有一些filer的话, 此时也会调用</p>
</li>
<li><p>格式化输出结果</p>
<p>通常情况下都是由layout层将event格式化成String型。当然也有意外比如说SocketAppender就是将event格式化成流。</p>
</li>
<li><p>输出LoggingEvent</p>
<p>将格式化好的结果, 输出到appender中记录的地址</p>
<p><img src= "/medias/detail/load.gif" data-lazy-src="/p/1779db1f/db17563b0ddeef1974a0618feb551abe.png"></p>
</li>
</ol>
<h2 id="pattern语法元素"><a href="#pattern语法元素" class="headerlink" title="pattern语法元素"></a>pattern语法元素</h2><p>在 Logback 中，<code>encoder</code> 的 <code>pattern</code> 属性用于定义日志的输出格式。通过 pattern，可以指定要包含的时间戳、日志级别、线程名、类名、消息等信息。Logback 使用了一种类似于 <code>printf</code> 风格的格式化方式来定义这些输出。</p>
<p>您可以在 Logback 官方文档中找到有关 pattern 的详细信息和指导，以下是相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://logback.qos.ch/manual/layouts.html#PatternLayout">Logback Manual - Pattern Layout</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://logback.qos.ch/manual/layouts.html#PatternLayout">Logback Manual - Pattern Options</a></li>
</ul>
<p>这些文档提供了对 Pattern 的详细解析、示例以及如何使用这些占位符进行日志格式化的更多信息，非常适合用作学习与参考</p>
<p>以下是 Logback 中 <code>pattern</code> 的基本语法元素和常用占位符：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">时间：</span><br><span class="line">%d 或 %<span class="built_in">date</span>：输出当前的日期和时间。</span><br><span class="line">例如，%d&#123;yyyy-MM-<span class="built_in">dd</span> HH:mm:ss&#125; 将输出成 2023-10-01 12:00:00。</span><br><span class="line">日志级别：</span><br><span class="line"></span><br><span class="line">%level 或 %p：输出日志的级别（如 DEBUG、INFO、ERROR 等）。</span><br><span class="line">线程信息：</span><br><span class="line"></span><br><span class="line">%thread：输出当前线程的名称。</span><br><span class="line">日志记录器名称：</span><br><span class="line"></span><br><span class="line">%logger：输出记录日志的类名或 Logger 名称，通常会使用 &#123;&#125; 指定字符数以限制输出长度。</span><br><span class="line">例如 %logger&#123;36&#125; 会限制 Logger 名称的输出为 36 个字符。</span><br><span class="line">消息内容：</span><br><span class="line"></span><br><span class="line">%msg：输出日志消息的内容。</span><br><span class="line">行分隔符：</span><br><span class="line"></span><br><span class="line">%n：输出换行符。</span><br><span class="line">其他信息：</span><br><span class="line"></span><br><span class="line">%F：当前日志被输出的文件名。</span><br><span class="line">%L：当前日志被输出的行号。</span><br><span class="line">%C：当前输出日志的类的全名。</span><br><span class="line">%M 来获取调用日志记录的类中的方法名</span><br></pre></td></tr></table></figure>

<p>示例：以下是一个包含各种元素的 <code>pattern</code> 示例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>%d&#123;yyyy-MM-dd HH:mm:ss&#125;</code>：输出格式化的日期和时间。</li>
<li><code>[%thread]</code>：输出当前线程名。</li>
<li><code>%-5level</code>：输出日志级别，并左对齐，占用 5 个字符宽度。</li>
<li><code>%logger&#123;36&#125;</code>：输出 Logger 名称，最多显示 36 个字符。</li>
<li><code>%msg</code>：输出实际的日志消息。</li>
<li><code>%n</code>：在每条日志信息的末尾换行。</li>
</ul>
<p>这个示例将产生如下格式的输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2023-10-01 12:00:00 [main] INFO  com.example.MyClass - 这是一个日志消息</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://fulsun.github.io">凉月</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://fulsun.github.io/p/1779db1f">https://fulsun.github.io/p/1779db1f</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://fulsun.github.io" target="_blank">凉月の博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java%E6%97%A5%E5%BF%97/">Java日志</a><a class="post-meta__tags" href="/tags/Logback/">Logback</a></div><div class="post_share"><div class="social-share" data-image="/medias/featureimages/010.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/p/9d3b5342" title="封装Log4j日志思路"><img class="cover" src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/002.jpg" onerror="onerror=null;src='/medias/detail/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">封装Log4j日志思路</div></div></a></div><div class="next-post pull-right"><a href="/p/cf904808" title="Slf4j的运行原理"><img class="cover" src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/001.jpg" onerror="onerror=null;src='/medias/detail/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Slf4j的运行原理</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/p/5ad1720d" title="Slf4j的使用"><img class="cover" src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/003.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-14</div><div class="title">Slf4j的使用</div></div></a></div><div><a href="/p/b41723d6" title="Java日志体系"><img class="cover" src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/012.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-14</div><div class="title">Java日志体系</div></div></a></div><div><a href="/p/cf904808" title="Slf4j的运行原理"><img class="cover" src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/001.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-15</div><div class="title">Slf4j的运行原理</div></div></a></div><div><a href="/p/9d3b5342" title="封装Log4j日志思路"><img class="cover" src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/002.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">封装Log4j日志思路</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/medias/detail/load.gif" data-lazy-src="/medias/avatar.jpg" onerror="this.onerror=null;this.src='/medias/detail/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">凉月</div><div class="author-info__description">记录生活,分享知识。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/fulsun"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/fulsun" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:fl_6145@163.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">感谢访问本站，若喜欢请收藏 ^_^</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B9%E8%8A%82%E7%82%B9"><span class="toc-text">根节点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-text">属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E8%8A%82%E7%82%B9"><span class="toc-text">子节点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#appender"><span class="toc-text">appender</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ConsoleAppender"><span class="toc-text">ConsoleAppender</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FileAppender"><span class="toc-text">FileAppender</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RollingFileAppender-%E5%B8%B8%E7%94%A8"><span class="toc-text">RollingFileAppender [常用]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E7%AD%96%E7%95%A5"><span class="toc-text">滚动策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TimeBaseRollingPolicy"><span class="toc-text">TimeBaseRollingPolicy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SizeBasedTriggeringPolicy"><span class="toc-text">SizeBasedTriggeringPolicy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SizeAndTimeBasedRollingPolicy"><span class="toc-text">SizeAndTimeBasedRollingPolicy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E8%8A%82%E7%82%B9"><span class="toc-text">过滤节点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%A7%E5%88%AB%E8%BF%87%E6%BB%A4%E5%99%A8%EF%BC%88LevelFilter%EF%BC%89"><span class="toc-text">级别过滤器（LevelFilter）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%B4%E7%95%8C%E5%80%BC%E8%BF%87%E6%BB%A4%E5%99%A8%EF%BC%88ThresholdFilter%EF%BC%89"><span class="toc-text">临界值过滤器（ThresholdFilter）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E5%80%BC%E8%BF%87%E6%BB%A4%E5%99%A8%EF%BC%88EvaluatorFilter%EF%BC%89"><span class="toc-text">求值过滤器（EvaluatorFilter）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%99%A8%EF%BC%88Matchers%EF%BC%89"><span class="toc-text">匹配器（Matchers）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#logger-%E8%8A%82%E7%82%B9"><span class="toc-text">logger 节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#root-%E8%8A%82%E7%82%B9"><span class="toc-text">root 节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#logger-%E5%92%8C-root%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">logger 和 root的关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#logback-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-text">logback 执行流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pattern%E8%AF%AD%E6%B3%95%E5%85%83%E7%B4%A0"><span class="toc-text">pattern语法元素</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/p/94e3914c" title="Import 注册组件"><img src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/008.jpg" onerror="this.onerror=null;this.src='/medias/detail/404.jpg'" alt="Import 注册组件"/></a><div class="content"><a class="title" href="/p/94e3914c" title="Import 注册组件">Import 注册组件</a><time datetime="2024-07-15T22:24:08.000Z" title="发表于 2024-07-15 22:24:08">2024-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/a0c53761" title="Configuration Bean 注册组件"><img src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/012.jpg" onerror="this.onerror=null;this.src='/medias/detail/404.jpg'" alt="Configuration Bean 注册组件"/></a><div class="content"><a class="title" href="/p/a0c53761" title="Configuration Bean 注册组件">Configuration Bean 注册组件</a><time datetime="2024-07-15T21:24:08.000Z" title="发表于 2024-07-15 21:24:08">2024-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/65826306" title="Spring5新功能"><img src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/008.jpg" onerror="this.onerror=null;this.src='/medias/detail/404.jpg'" alt="Spring5新功能"/></a><div class="content"><a class="title" href="/p/65826306" title="Spring5新功能">Spring5新功能</a><time datetime="2024-07-14T17:24:08.000Z" title="发表于 2024-07-14 17:24:08">2024-07-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/40bb048a" title="JdbcTemplate与声明式事务"><img src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/013.jpg" onerror="this.onerror=null;this.src='/medias/detail/404.jpg'" alt="JdbcTemplate与声明式事务"/></a><div class="content"><a class="title" href="/p/40bb048a" title="JdbcTemplate与声明式事务">JdbcTemplate与声明式事务</a><time datetime="2024-07-14T11:24:08.000Z" title="发表于 2024-07-14 11:24:08">2024-07-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/92933cdb" title="Spring-AOP编程"><img src= "/medias/detail/load.gif" data-lazy-src="/medias/featureimages/012.jpg" onerror="this.onerror=null;this.src='/medias/detail/404.jpg'" alt="Spring-AOP编程"/></a><div class="content"><a class="title" href="/p/92933cdb" title="Spring-AOP编程">Spring-AOP编程</a><time datetime="2024-07-14T09:24:38.000Z" title="发表于 2024-07-14 09:24:38">2024-07-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 凉月</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.js"></script><script src="https://unpkg.com/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline-fulsun.netlify.app/.netlify/functions/comment',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))

    const destroyWaline = () => {
      waline.destroy()
    }

    btf.addGlobalFn('pjax', destroyWaline, 'destroyWaline')
  }

  const loadWaline = async () => {
    if (initFn) initWaline(initFn)
    else {
      await getCSS('https://unpkg.com/@waline/client@3.1.2/dist/waline.css')
      const { init } = await import('https://unpkg.com/@waline/client@3.1.2/dist/waline.js')
      initFn = init || Waline.init
      initWaline(initFn)
      window.walineFn = initFn
    }
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://unpkg.com/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>